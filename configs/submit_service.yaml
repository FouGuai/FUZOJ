server:
  addr: "0.0.0.0:8086"
  readTimeout: 5s
  writeTimeout: 10s
  idleTimeout: 60s

logger:
  level: "info"
  format: "json"
  outputPath: "stdout"
  errorPath: "stderr"
  service: "submit-service"
  env: "dev"
  cluster: "default"

database:
  dsn: "user:password@tcp(127.0.0.1:3306)/fuzoj?parseTime=true&loc=Local"
  maxOpenConnections: 25
  maxIdleConnections: 5
  connMaxLifetime: "5m"
  connMaxIdleTime: "10m"

redis:
  addr: "127.0.0.1:6379"
  password: ""
  db: 0
  maxRetries: 3
  minRetryBackoff: "8ms"
  maxRetryBackoff: "512ms"
  dialTimeout: "5s"
  readTimeout: "3s"
  writeTimeout: "3s"
  poolSize: 20
  minIdleConns: 2
  poolTimeout: "4s"
  connMaxIdleTime: "10m"
  connMaxLifetime: "30m"

kafka:
  brokers: ["127.0.0.1:9092"]
  clientID: "submit-service"

topics:
  level0: "judge.level0"
  level1: "judge.level1"
  level2: "judge.level2"
  level3: "judge.level3"

minio:
  endpoint: "127.0.0.1:9000"
  accessKey: "minioadmin"
  secretKey: "minioadmin"
  useSSL: false
  bucket: "fuzoj"

submit:
  sourceBucket: "fuzoj"
  sourceKeyPrefix: "submissions"
  maxCodeBytes: 262144
  idempotencyTTL: 10m
  batchLimit: 200
  statusTTL: 24h
  statusFinalTopic: "judge.status.final"
  statusFinalConsumer:
    consumerGroup: "submit-service-status-final"
    prefetchCount: 1
    concurrency: 2
    maxRetries: 3
    retryDelay: 1s
    deadLetterTopic: "judge.status.final.dead"
    messageTTL: 10m
  submissionCacheTTL: 30m
  submissionEmptyTTL: 5m
  rateLimit:
    userMax: 30
    ipMax: 60
    window: 1m
  timeouts:
    db: 3s
    cache: 1s
    mq: 3s
    storage: 5s
    status: 2s
